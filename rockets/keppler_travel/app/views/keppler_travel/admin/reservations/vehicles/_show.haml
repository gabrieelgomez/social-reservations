.container
  .row
    .col-lg-2
      = link_to admin_travel_reservations_path(model_name: @model.downcase, type_search: params[:type_search]), class: "", "data-position" => "bottom", "data-tooltip" => t("keppler.actions.back") do
        .arrow-back.btn.btn-default
          %i.fa.fa-angle-left
          = t('keppler.actions.back')
  .show-section
    .row
      .col-lg-12
        .box.slice-box
          .box-header.with-border
            %h3.box-title
              Keppler Travel
              #{params[:model_name].pluralize.titleize} ->
              Datos de Reservación
            .box-tools.pull-right
              - if can?(KepplerTravel::Reservation).destroy?
                = link_to admin_travel_reservation_path(@reservation), class: "btn btn-box-tool", title: "#{t('keppler.actions.delete')}", method: :delete, data: { confirm: t("keppler.messages.data_confirm") } do
                  %i.icon-trash

              - if @type_search == 'agency'
                = link_to edit_admin_travel_reservation_path(@reservation, model_name: params[:model_name], type_search: params[:model_name]), class: 'new-menu', title: t('keppler.actions.edit') do
                  %i.icon-pencil
                  = t('keppler.actions.edit')
      .col-lg-8
        .box-body.box-body-no-padding
          .invoice-transfers__box
            .row
              .col-xs-12
                .row
                  .col-lg-2
                    %img{:alt => "", :src => "/assets/img/isotipo-receptivo-colombia-invoice.svg", :width => "120px"}/
                  .col-lg-6
                    %h2 Receptivo Colombia
                    %p Operador turístico - Bogotá, Colombia
                  .col-lg-1
                  .col-lg-3
                    %h3.pull-right="N° de Orden #{@reservation.invoice.id}"
                %hr/
                .row
                  .col-xs-12
                    %address
                      %strong Datos del Cotizante
                      %br/
                      = @reservation.user.name
                      %br/
                      = @reservation.user.phone.blank? ? '-----------' : @reservation.user.phone
                      %br/
                      = @reservation.user.email
                      %br/
                      = @reservation.invoice.address.blank? ? '-----------' : @reservation.invoice.address
                .row
                  .col-xs-12.col-lg-3
                    %address
                      %strong Método de Pago
                      %br/
                      Pĺataforma: EnLineaPagos
                      %br/
                  .col-xs-12.col-lg-3
                    %address
                      %strong Tipo de Moneda
                      %br/
                      = @reservation.invoice.currency.upcase
                      %br/
                      %br/
                  .col-xs-12.col-lg-3
                    %address
                      %strong Estatus Reserva
                      %br/
                      %span.badge.badge-pill{class: @reservation.order.status_class?}= t("keppler.messages.#{@reservation.order.status}")
                      -#Status / Color
                        Green / Approved  ---- .btn-success
                        Red  / Canceled   ---- .btn-danger
                        Yellow / Pending  ---- .btn-warning
                      %br/
                      %br/

                  .col-xs-12.col-lg-3
                    %address
                      %strong Estatus Pago
                      %br/
                      %span.badge.badge-pill{class: @reservation.order.status_pay_class?}= t("keppler.messages.#{@reservation.order.status_pay}")
                      %br/
                      %br/

                  .col-xs-12.col-lg-3
                    %address
                      %strong N°. Orden ELP
                      %br/
                      = @reservation.invoice.token
                      %br/
                      %br/
                .row
                  .col-xs-12
                    %h4.text-center Información del Traslado
                    %br/
                  .col-xs-12.col-lg-4
                    %address
                      %strong Origen
                      %br/
                      -#= field(@reservation.origin)
                      = @reservation.origin.blank? ? '-----------' : @reservation.origin
                      %br/
                      %strong Destino
                      %br/
                      = @reservation.arrival.blank? ? '-----------' : @reservation.arrival
                      %br/
                      %strong Aerolinea - Ida
                      %br/
                      = @reservation.airline_origin.blank? ? '-----------' : @reservation.airline_origin
                      %br/
                      %strong Aerolinea - Vuelta
                      %br/
                      = @reservation.airline_arrival.blank? ? '-----------' : @reservation.airline_arrival
                      %br/
                  .col-xs-12.col-lg-4
                    %address
                      %strong Tipo de Traslado
                      %br/
                      - if @reservation.round_trip == 'true'
                        Ida/Vuelta
                      -else
                        Ida
                      %br/
                      %strong Adultos/Niños
                      %br
                      = "#{@reservation.quantity_adults.to_i} / #{@reservation.quantity_kids.to_i}"
                      %br/
                      %strong N° de Vuelo - Ida
                      %br/
                      = @reservation.flight_number_origin.blank? ? '-----------' : @reservation.flight_number_origin
                      %br/
                      %strong N° de Vuelo - Vuelta
                      %br/
                      = @reservation.flight_number_arrival.blank? ? '-----------' : @reservation.flight_number_arrival
                      %br/
                  .col-xs-12.col-lg-4
                    %address
                      %strong Fecha/Hora de Ida
                      %br/
                      = @reservation.flight_origin.blank? ? '-----------' : @reservation.flight_origin
                      %br/
                      %strong Fecha/Hora de Vuelta
                      %br/
                      = @reservation.flight_arrival.blank? ? '-----------' : @reservation.flight_arrival
                      %br
                      %strong Hora Traslado Ida
                      %br/
                      = @reservation.hour_origin.blank? ? '-----------' : @reservation.hour_origin
                      %br/
                      %strong Hora Traslado Vuelta
                      %br/
                      = @reservation.hour_arrival.blank? ? '-----------' : @reservation.hour_arrival
                      %br
                      %strong Equipaje
                      %br/
                      = @reservation.quantity_kit
                      piezas
                  .col-xs-12.col-lg-12
                    %address
                      %strong Observaciones
                      %br/
                      = @reservation.description.blank? ? '-----------' : @reservation.description
                      %br
                  .col-xs-12.col-lg-12
                    %strong Datos de los Viajeros
                    %br/
                    %table.table.table-striped#travellers
                      -#%thead
                        %tr
                          %th
                      %tbody
                        - @reservation.travellers.each_with_index do |traveller, index|
                          %tr.list-row{style:'background-color: transparent !important;'}
                            %td.display-value.fs-body-1.tc-black-2{style:'border-top: 1px solid transparent !important;'}
                            = traveller.name.blank? ? '-----------' : "#{traveller.name.titleize} - #{traveller.dni}"
                .row
                  .col-xs-12.col-lg-12
                    .panel.panel-default
                      .panel-heading
                        %h3.panel-title
                          %strong Información del Vehiculo
                      .panel-body
                        .table-responsive
                          %table.table.table-condensed
                            %thead
                              %tr
                                %td.text-center
                                  %strong= t("activerecord.attributes.title")
                                %td.text-center
                                  %strong= t("activerecord.attributes.kit_weight")
                                %td.text-center
                                  %strong= t("activerecord.attributes.kit_quantity")
                                %td.text-center
                                  %strong= t("activerecord.attributes.seat_max")
                            %tbody
                              %tr
                                %td.text-center= @reservation.reservationable.title.blank? ? '-----------' : @reservation.reservationable.title['es']
                                %td.text-center= @reservation.reservationable.kit['weight'].blank? ? '-----------' : @reservation.reservationable.kit['weight']
                                %td.text-center= @reservation.reservationable.kit['quantity'].blank? ? '-----------' : @reservation.reservationable.kit['quantity']
                                %td.text-center= @reservation.reservationable.seat.blank? ? '-----------' : @reservation.reservationable.seat
                  %br
                  .col-xs-12.col-lg-12
                    .panel.panel-default
                      .panel-heading
                        %h3.panel-title
                          %strong Descripción
                      .panel-body
                        .table-responsive
                          %table.table.table-condensed
                            %thead
                              %tr
                                %td.text-center
                                  %strong Concepto
                                %td.text-center
                                  %strong Precio
                                %td.text-center
                                  %strong Cantidad
                                %td.text-center
                                  %strong Total
                            %tbody
                              %tr
                                %td.text-center= @reservation.reservationable.title['es']
                                %td.text-center= number_to_currency(@reservation.order.price_reservationable, locale: @locale)
                                %td.text-center= @reservation.multiple
                                %td.text-center= number_to_currency(@reservation.order.price_total_pax, locale: @locale)
                  - if @type_search == 'agency'
                    .col-xs-12.col-lg-12
                      .panel.panel-default
                        .panel-heading
                          %h3.panel-title
                            %strong Porcentajes de Agencia
                        .panel-body
                          .table-responsive
                            %table.table.table-condensed
                              %thead
                                %tr
                                  %td.text-center
                                    %strong Concepto
                                  %td.text-center
                                    %strong Valor
                                  %td.text-center
                                    %strong Subtotal
                                  %td.text-center
                                    %strong Total
                              %tbody
                                %tr
                                  %td.text-center Comisión
                                  %td.text-center= "#{@reservation.order.comission} %"
                                  %td.text-center= number_to_currency(@reservation.order.price_comission, locale: @locale)
                                  %td.text-center -----

                                %tr
                                  %td.text-center Prestación
                                  %td.text-center= "#{@reservation.order.lending} %"
                                  %td.text-center= number_to_currency(@reservation.order.price_lending, locale: @locale)
                                  %td.text-center -----

                                %tr
                                  %td.text-center Total PAX
                                  %td.text-center -----
                                  %td.text-center -----
                                  %td.text-center= number_to_currency(@reservation.order.price_total_pax, locale: @locale)

                                %tr
                                  %td.text-center Total Agencia
                                  %td.text-center -----
                                  %td.text-center -----
                                  %td.text-center= number_to_currency(@reservation.order.price_total_agency, locale: @locale)
          %br
          %br
          %br
          %br
          %br
      .col-xs-12.col-lg-4
        .box.slice-box
          .box-header.with-border
            %h3.box-title Conductor Asignado
          .box-body.box-body-no-padding
            %table.table.table-striped
              %tbody
                %tr.list-row
                  %th.display-label Nombre y Apellido
                  %td.display-value.fs-body-1.tc-black-2
                    - unless @reservation.driver.nil?
                      .col-lg-8.pull-left
                        = @reservation.driver.user.name
                      -# - unless @reservation.order.status.eql?('complete')
                      .col-lg-4
                        = link_to admin_travel_reservations_unassign_driver_path(reservation_id: @reservation.id), title: 'Remover Conductor', data: { confirm: t("keppler.messages.data_confirm") } do
                          %i.icon-close{style: 'color:red'}
                          -# .arrow-back.btn.btn-default
                          -#   = t('keppler.actions.unassign')
                    - else
                      = '-----------'
                %tr.list-row
                  %th.display-label Correo
                  %td.display-value.fs-body-1.tc-black-2
                    = @reservation.driver.nil? ? '-----------' : @reservation.driver.user.email
                %tr.list-row
                  %th.display-label Teléfono
                  %td.display-value.fs-body-1.tc-black-2
                    = @reservation.driver.nil? ? '-----------' : @reservation.driver.user.phone
            -# if @reservation.order.try(:status).try(:eql, 'complete')
            - if @reservation.driver.nil? && KepplerTravel::Driver.count.positive?
              = simple_form_for @reservation, url: '/admin/travel/reservations/assignment', data: { confirm: t("keppler.messages.data_confirm") }, method: :post do |f|
                %input{name: 'reservation_id', value: @reservation.id, type: 'hidden'}
                %input{name: 'model_name', value: params[:model_name], type: 'hidden'}
                %table.table.table-striped
                  %tbody
                    %tr.list-row
                      -# %th.display-label Lista de Conductores Disponibles
                      -# %td.display-value.fs-body-1.tc-black-2
                      -#   %select.form-control{name: 'driver_id', style:'border-radius: 0 !important;'}
                      -#     - @reservation.reservationable.drivers.each do |driver|
                      -#       %option{ value: driver.id}= driver.user.name
                      %th
                        %select#js-search-drive{name: 'driver_id', :multiple => "multiple", :style => ""}
                          - @reservation.reservationable.drivers.each do |driver|
                            %option{ value: driver.id}="#{driver.user.name} -  DNI #{driver.user.dni}"
                    %tr.list-row
                      %th.display-label= f.button :submit, t('keppler.actions.assignment'), name: '_save', class: 'btn-primary'

:scss
  .btn_remove{
    color: #f44336;
    font-weight: bold;
    font-size: 18px;
  }

  .select2-selection {
    border-radius: 0 !important;
  }
  .select2-container--default.select2-container--focus .select2-selection--multiple {
      border: solid #f44336 1px !important;
      outline: 0;
  }

  .select2-container--default .select2-selection--multiple .select2-selection__choice {
    background-color: #f44336 !important;
  }
  .select2-container--default .select2-selection--multiple .select2-selection__choice__remove {
    color: #fff !important;
  }

%script{src: "https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0/js/i18n/es.js"}
:javascript
  $(document).ready(function(){
    $("#js-search-drive").select2({
      language: "es",
      placeholder: "Buscar Conductor",
      allowClear: true,
      width: '100%',
      maximumSelectionLength: 1
    });
  });
