- reservationable = @reservation.reservationable
- invoice = @reservation.invoice

.container
  .row
    .col-lg-2
      = link_to admin_travel_reservations_path(model_name: @model.downcase), class: "", "data-position" => "bottom", "data-tooltip" => t("keppler.actions.back") do
        .arrow-back.btn.btn-default
          %i.fa.fa-angle-left
          = t('keppler.actions.back')

  .show-section
    .row
      .col-lg-12
        .box.slice-box
          .box-header.with-border
            %h3.box-title
              Keppler Travel
              #{params[:model_name].pluralize.titleize} ->
              Reservación #
              #{@reservation.id}
            .box-tools.pull-right
              - if can?(KepplerTravel::Reservation).update?
                = link_to edit_admin_travel_reservation_path(@reservation), class: "btn btn-box-tool", title: "#{t('keppler.actions.edit') }" do
                  %i.icon-pencil

              - if can?(KepplerTravel::Reservation).destroy?
                = link_to admin_travel_reservation_path(@reservation), class: "btn btn-box-tool", title: "#{t('keppler.actions.delete')}", method: :delete, data: { confirm: t("keppler.messages.data_confirm") } do
                  %i.icon-trash

      .col-lg-8
        .box-body.box-body-no-padding
          .invoice-transfers__box
            .row
              .col-xs-12
                .row
                  .col-lg-2
                    %img{:alt => "", :src => "/assets/img/isotipo-receptivo-colombia-invoice.svg", :width => "120px"}/
                  .col-lg-6
                    %h2 Receptivo Colombia
                    %p Operador turístico - Bogotá, Colombia
                  .col-lg-1
                  .col-lg-3
                    %h3.pull-right="N° de Orden #{invoice.id}"
                %hr/
                .row
                  .col-xs-12
                    %address
                      %strong Datos del Cotizante
                      %br/
                      = @reservation.user.name
                      %br/
                      = @reservation.user.phone.blank? ? '-----------' : @reservation.user.phone
                      %br/
                      = @reservation.user.email
                      %br/
                      = invoice.address.blank? ? '-----------' : invoice.address
                .row
                  .col-xs-12.col-lg-3
                    %address
                      %strong Pago Total
                      %br/
                      = number_to_currency(invoice.amount, locale: @locale)
                      %br/
                  .col-xs-12.col-lg-3
                    %address
                      %strong Tipo de Moneda
                      %br/
                      = invoice.currency.upcase
                      %br/
                      %br/
                  .col-xs-12.col-lg-3
                    %address
                      %strong Estatus Reserva
                      %br/
                      %span.badge.btn-warning= invoice.status
                      -#Status / Color
                        Green / Approved  ---- .btn-success
                        Red  / Canceled   ---- .btn-danger
                        Yellow / Pending  ---- .btn-warning
                      %br/
                      %br/
                  .col-xs-12.col-lg-3
                    %address
                      %strong N°. Orden ELP
                      %br/
                      = invoice.token
                      %br/
                      %br/
                .row
                  .col-xs-12.col-lg-12
                    %h4.text-center Información del Multidestino
                    %br/
                  .col-xs-12.col-lg-3
                    %address
                      %strong Origen
                      %br/
                      = @reservation.origin.blank? ? '-----------' : @reservation.origin
                      %br/
                  .col-xs-12.col-lg-3
                    %address
                      %strong Fecha de Ida
                      %br/
                      = @reservation.flight_origin.blank? ? '-----------' : @reservation.flight_origin
                      %br/
                  .col-xs-12.col-lg-3
                    %address
                      %strong Adultos/Niños
                      %br/
                      = "#{@reservation.quantity_adults.to_i} / #{@reservation.quantity_kids.to_i}"
                      %br/
                  .col-xs-12.col-lg-3
                    %address
                      %strong Tipo de Alojamiento
                      %br/
                      = "Tipo de Alojamiento"
                      %br/
                  .col-xs-12.col-lg-12
                    %address
                      %strong Observaciones
                      %br/
                      = @reservation.description.blank? ? '-----------' : @reservation.description
                      %br
                  .col-xs-12
                    %strong Datos de los Viajeros
                    %br/
                    %table.table.table-striped#travellers
                      -#%thead
                        %tr
                          %th
                      %tbody
                        - @reservation.travellers.each_with_index do |traveller, index|
                          %tr.list-row{style:'background-color: transparent !important;'}
                            %td.display-value.fs-body-1.tc-black-2{style:'border-top: 1px solid transparent !important;'}
                            = traveller.name.blank? ? '-----------' : "#{traveller.name.titleize} - #{traveller.dni}"
                .row
                  - if @reservation.order.table_reservationable
                    .col-xs-12.col-lg-12
                      .panel.panel-default
                        .panel-heading
                          %h3.panel-title
                            %strong Descripción
                        .panel-body
                          .table-responsive
                            %table.table.table-condensed
                              %thead
                                %tr
                                  %td.text-center
                                    %strong Concepto
                                  %td.text-center
                                    %strong Precio
                                  %td.text-center
                                    %strong Cantidad
                                  %td.text-center
                                    %strong Total
                              %tbody
                                - @reservation.order.table_reservationable['pricing_table'].each do |room|
                                  -# - unless room.keys.include?(:total_price_table)
                                  %tr
                                    - if room['type'] == 'children'
                                      %td{style:'text-align:left!important;'}= "Cant. Niños"
                                    - else
                                      %td{style:'text-align:left!important;'}= "Habitación #{room['type']}"
                                    %td= number_to_currency(room['price'], locale: @locale)
                                    %td= room['quantity']
                                    %td= number_to_currency(room['total_room'], locale: @locale)

                                %tr
                                  %td{style:'text-align:left!important;'}= "Cant. Adultos"
                                  %td -----
                                  %td= @reservation['quantity_adults']
                                  %td= number_to_currency(@reservation.order.table_reservationable['total_rooms_per'], locale: @locale)

                                %tr
                                  %td{style: 'border-top: 2px solid #000;'} -----
                                  %td{style: 'border-top: 2px solid #000;'} -----
                                  %td{style: 'border-top: 2px solid #000;'} -----
                                  %td{style: 'border-top: 2px solid #000;'}= number_to_currency(@reservation.order.table_reservationable['total_price_table'], locale: @locale)

                  - if @type_search == 'agency'
                    .col-md-12
                      .panel.panel-default
                        .panel-heading
                          %h3.panel-title
                            %strong Porcentajes de Agencia
                        .panel-body
                          .table-responsive
                            %table.table.table-condensed
                              %thead
                                %tr
                                  %td.text-center
                                    %strong Concepto
                                  %td.text-center
                                    %strong Valor
                                  %td.text-center
                                    %strong Subtotal
                                  %td.text-center
                                    %strong Total
                              %tbody
                                %tr
                                  %td.text-center Comisión
                                  %td.text-center= "#{@reservation.order.comission} %"
                                  %td.text-center= number_to_currency(@reservation.order.price_comission, locale: @locale)
                                  %td.text-center -----

                                %tr
                                  %td.text-center Prestación
                                  %td.text-center= "#{@reservation.order.lending} %"
                                  %td.text-center= number_to_currency(@reservation.order.price_lending, locale: @locale)
                                  %td.text-center -----

                                %tr
                                  %td.text-center Total PAX
                                  %td.text-center -----
                                  %td.text-center -----
                                  %td.text-center= number_to_currency(@reservation.order.price_total_pax, locale: @locale)

                                %tr
                                  %td.text-center Total Agencia
                                  %td.text-center -----
                                  %td.text-center -----
                                  %td.text-center= number_to_currency(@reservation.order.price_total_agency, locale: @locale)
          %br
          %br
          %br
          %br
          %br
