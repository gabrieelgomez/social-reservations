%section#seach-widget
  .container
    - unless @results.blank?
      .box-search
        .container
          .row.row-flex
            .col-lg-9
              .row
                .items-search
                  .col-lg-12
                    %span
                      Su búsqueda:
                  .col-lg-4
                    %span
                      ="Destino: #{@results.title[@lang]}".titleize
                  .col-lg-4
                    %span
                      ="Fecha: #{@flight_origin_tour_picker}"
                  .col-lg-2
                    %span
                      ="Adultos: #{@adults}"
                  .col-lg-2
                    %span
                      ="Niños: #{@kids}"

            .col-lg-3
              %p
                %span
                  %a.pull-right.link-widget
                    Volver a relizar la búsqueda

  .container.js-widget.js-hide-widget.widget-results
    .row
      .col-lg-12
        = render 'app/layouts/widget'
%br
%br

%section#tours_.tours_
  - unless @results.blank?
    .banner-tours{:style => "background-image: url(#{@results.banner.url})"}
      .banner-tours--mask
        %h2= @results.title[@lang].titleize
        %p= @results.subtitle[@lang].titleize

  -#.container
    - unless @results.blank?
      .gallary-header.text-center
        %h2= @results.title[@lang].titleize
        %p
          //Description tours
          Duis aute irure dolor in velit esse cillum dolore eu fugiat nulla.
  .content-tours
    .container
      .row
        - if @results.blank?
          .col-lg-12
            .box-results
              .image-search
                = image_tag '/assets/img/loupe.svg'
              .gallary-header.text-center
                %h2
                  ¡Lo sentimos! No hemos encontrado ningún resultado.
                %p
                  = link_to root_path do
                    Volver a relizar la búsqueda

        - else
          .col-lg-7
            .content-tours__description
              %h3 Descripción
              .content-tours__description--summary
                %p= raw @results.description[@lang]
            -#.content-tours__data
              .row
                .col-lg-12
                  .row
                    .col-lg-4
                      .form-group
                        %label Fecha de Reserva
                        %input.form-control{value: @flight_origin_tour_picker, disabled: 'disabled'}/
                    .col-lg-4
                      .form-group
                        %label Cantidad de Adultos
                        %input.form-control{value: @adults, disabled: 'disabled'}/
                    .col-lg-4
                      .form-group
                        %label Cantidad de Niños
                        %input.form-control{value: @kids, disabled: 'disabled'}/
            -#.content-tours__button
              .row
                .col-lg-12.pull-left
                  = link_to reservations_path(@lang, @currency, 'tour', @results, quantity_adults: @adults, quantity_kids: @kids, flight_origin_tour_picker: @flight_origin_tour_picker) do
                    %button.about-view.packages-btn.btn-reservation
                      Reservar
            .content-tours__button
              .row
                .col-lg-12
                  %center
                    %span.price
                      Costo por Adulto:
                      %h3.price
                        -# 999999,00
                        = number_to_currency(@results.price_adults[@currency], locale: @locale)

                    -#%br
                    -#%span.price
                      Costo por Niño:
                      %h3.price
                        -# 999999,00
                        = number_to_currency(@results.price_kids[@currency], locale: @locale)
                -# User click from a Cards - Condition
                - unless @flight_origin_tour_picker
                  .col-lg-offset-2.col-lg-8
                    = search_form_for @q, url: "/#{@lang}/#{@currency}/reservations/tour/#{@results.id}", html: {class: 'input-group', style:'width: 100%;', id: 'search-metadata', method: :get } do |f|
                      .row
                        %center
                          .col-lg-6
                            .form-group
                              %input.form-control.custom-input{name: 'flight_tour_data', id: 'flight_tour_data', autocomplete: 'off'}/
                          .col-lg-3
                            .form-group
                              %input.form-control{name: 'quantity_adults', :type => "number", min: 1, value: 2, :placeholder => "Adultos"}/
                          .col-lg-3
                            .form-group
                              %input.form-control{name: 'quantity_kids', :type => "number", min: 0, :placeholder => "Niños"}/
                      .col-lg-12
                        %br
                        %br
                        %center
                          %button.about-view.packages-btn.btn-reservation{style: 'width: 165px;height: 48px;font-size: 14px;', type: 'submit'}
                            solicitar
                            %br/
                            reservación
                - else
                  .col-lg-12
                    %center
                      = link_to reservations_path(@lang, @currency, 'tour', @results, quantity_adults: @adults, quantity_kids: @kids, flight_origin_tour_picker: @flight_origin_tour_picker) do
                        %button.about-view.packages-btn.btn-reservation
                          solicitar
                          %br/
                          reservación

          .col-lg-5
            .content-tours__image
              .carrusel-galery
                .galery
                  - @results.files.each_with_index do |image|
                    .galery__item
                      %img{:alt => "", :src => image.url, :class => "img-responsive"}/

          .content-tours__tab
            .col-lg-12
              .content-tours__tab--box
                %ul.nav.nav-tabs.nav-item-tours
                  %li.active
                    %a{"data-toggle" => "tab", :href => "#includes"} Actividades
                  %li
                    %a{"data-toggle" => "tab", :href => "#description"} Descripción
                .tab-content
                  #includes.tab-pane.active
                    .box-includes
                      %h4 Incluye
                      %p= raw @results.task[@lang]
                  #description.tab-pane
                    .box-description
                      %h4 Descripción
                      = raw @results.description[@lang]


:javascript
  // Tours
  $( function() {
    function populateEndDate() {
      var date2 = $('#flight_tour_data').datetimepicker('getDate');
      date2.setDate(date2.getDate() + 3);
    }

    $("#flight_tour_data").datetimepicker({
      dateFormat: "dd-mm-yy",
      minDate: 3,
      onSelect: function(date) {
        populateEndDate();
        var date = $('#flight_tour_data').val();
        $('#reservation_flight_origin_data').val(date);
      }
    }).datetimepicker("setDate", new Date());
  } );
  // End --- Tours

  $('#search-metadata').validate({
    event: "blur",
    errorClass: "error-class",
    validClass: "valid-class",
    rules: {
      'flight_tour_data': { required: true},
      'quantity_adults': { required: true},
    },
    messages: {
      'flight_tour_data': 'No puede estar en blanco',
      'quantity_adults': 'No puede estar en blanco'
    },
    debug: true,
    errorElement: "label",
    submitHandler: function (form) {
      form.submit();
    }

  });
